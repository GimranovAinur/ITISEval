'239729 |@words однажды руководство наш организация поставить задача включить офис:2 друг город основный корпоративный:2 сеть:7 при:5 это:3 внутри использоваться:3 несколько виртуальный:11 vlan:3 для:7 телефония доступ база:2 дать:3 управление оборудование некоторые причина удаться:2 арендовать прямая канал:2 проброс этот:2 vlan-:2 так:3 как:3 роль внешний маршрутизотор оба выступать машина centos:2 транзит внутренний:2 трафик:5 быть:4 решить:2 использовать:2 openvpn:17 первоначальный идея отдельный туннель:2 каждый быстро отказаться связь низка масштабируемость решение:2 помощь прийти проект open:4 vswitch:4 программный коммутатор поддержка ieee 802 схема настройка:5 хабра достаточно:2 много информация:2 поэтому сразу привести конфигурация:3 некоторый комментарий cервераlocal dev:2 tap:3 etc:11 keys:9 crt:4 cert:2 server:2 key:6 dh1024 pem tls-server tls-auth:2 keepalive:2 ping-timer-rem:2 persist-tun:2 persist-key:2 daemon:2 user:2 nobody:4 group:2 bridge:5 shконфигурация клиентаclient remote nobind client:2 resolv-retry infinite shскрипт bin:3 bash usr:2 ovs-vsctl:6 del-port ovs0:7 add-port:3 trunks=1996,1997,1998,1999 sbin link set:2 устройство:2 возможность:3 передавать:2 ethernet-кадр скрипт внесение:2 сетевой:2 tap-устройство:2 свитч:10 ovs:6 рестарт openvpn-демон необходимый:2 вывести повторно внести без данный:2 костыль он:5 поступать проблема пока-что красиво сложно догадаться параметр tunks описывать порт:4 тегировать указанный влан большинство современный дистрибутив уже присутствовать:2 целиком только модуль ядро пакет:2 демон:2 прийтись искать сторонний репозиторий либо собирать самый сборка процесс должный вызвать какой-либо затруднение после установка запуск создать создаваться:3 конфигурационный:3 файл:3 интерфейс:9 ifcfg-ovs0 device=ovs0 onboot=yes:2 devicetype=ovs:3 type=ovsbridge bootproto=static:2 hotplug=no:3 что:4 соответствовать:3 команда:4 add-br ovs0настройка практически ничто отличаться обычный системный ifcfg-eth0 197:6 physdevice=eth0 device=eth0 type=ovsport bridge=ovs0:2 options=:2 tag=197:3 bootproto=none eth0:7 заметить добавление ip-адрес:2 переставать доступный необходимость север использование:2 vlan-а нужно перенести ifcfg-vi197 случай:2 выглядеть device=vi197 onboot=no type=ovsintport ipaddr=10 120 253 netmask=255 255:2 arpcheck=no vi197:2 interface:7 type=internal аналогия остальной просмотреть текущий состояние можно:2 show мыть получиться:2 такой скрытый текст port:6 198:4 tag:4 vi198:2 type:2 internal:2 199:3 tap0:2 trunks 1996 1997 1998 1999 version заключение итог получать прохождение тегированный шифровать через интернет легко:2 масштабировать добавлять новое:2 vlan-ы удалённый вместо встроить gre-тунель пока время разобраться уверенный счёт шифрование