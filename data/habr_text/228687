'228687 |@words умный:5 указатель:4 часто передаваться другой функция:3 константный:5 ссылка:10 эксперт c++:2 андрей александреска скотт мейэрс герб:2 саттереть обсуждать этот:7 вопрос конференция and:2 beyond 2011 смотреть 04_34 shared ptr:6 performance correctness суть который:5 передать уже жить текущий область видимость где-то вызывающий код:5 если храниться член:2 класс:2 мочь:5 случиться так:2 что:10 быть:3 обнулить это:11 проблема:2 передача:5 архитектура политика владение пост про корректность здесь:2 рассмотреть производительность:2 получить при:3 переход один:3 взгляд показаться единственный выгода:3 отсутствие:2 атомарный:5 инкремент декремент счётчик:2 вызов:4 конструктор:2 копирование:2 деструктор:2 давать:5 написать:2 немного посмотреть:5 более внимательно происходить:2 под капот перевод статья blog linderdaum com 2014 smart-pointers-passed-by-const-reference для:3 начало несколько вспомогательный const:6 size:5 num:4 calls:4 10000000:6 double:6 getseconds:5 return:4 clock:5 clocks per sec void:6 printelapsedtime:3 elapsedtime:2 printf:2 mcalls float интрузивный class:4 iintrusivecounter:3 public:4 frefcounter:3 virtual ~iintrusivecounter increfcount:5 frefcounter++ decrefcount:4 delete this:2 private:3 std _atomic int:3 hoc template clptr:10 fobject:9 fobject-:4 object:2 ~clptr operator:2 temp temp- inline пока весь:6 достаточно просто:2 объявить простой:2 экземпляр передавать вначале значение:3 потом cltestobject:6 fpayload:2 32167 сделать:3 что-нибудь полезный fpayload++ теперь:2 можно:2 непосредственно бенчмарка processbyvalue:3 processbyconstref:2 main:3 obj:3 new for:4 j++:2 starttime:4 i++:2 собрать:2 сначала неоптимизировать версия:8 использовать gcc:4 exe 20140420 experimental -o0 cpp:2 -lstdc++:2 -std=c++11:2 скорость работа 375 мвызов по-значение:3 против 124 mвызов по-константной-ссылка:3 убедительный разница отладочный:3 сборка:2 хорошо:2 ассемблерный листинг:2 l25:3 leal:5 -60:3 ebp:9 eax:18 -64:2 edx:2 movl:16 esp:20 ecx:5 call:10 zn5clptri12cltestobjectec1erks1 вызывать:2 subl:3 z14processbyvalue5clptri12cltestobjecte zn5clptri12cltestobjected1ev addl:5 -32:2 l24:3 cmpl:2 jne:4 обратить внимание сколько:2 стать:2 чистый даже билд l29:2 z17processbyconstrefrk5clptri12cltestobjecte -40:2 l28 свой место удаться сэкономить два довольно-таки дорогой операция:4 мы нужно ведь оптимизировать:2 произойти -o3 выполняться 168 секунда миллион время:2 выполняние опуститься буквально нуль ошибка важный итерация выполнение тест нулевой ассемблер чтобы убедиться ошибиться где-нибудь вот:3 fildl:3 fdivs lc0:2 fstpl:2 p2align ,10 lock:2 заинлайненный скомпилировать строка впечатлять l23:2 ещё она:2 работать столько быстро измерить предвычесленный окончательный результат:2 никакой цикл:2 ничто lc2 flds fdivr fdivp fsubrp поместиться бенчмарк позволить оптимизатор:2 залезть развернуть предвычислить конечно пример тривиальный однако позволять:2 чётко говорить 2-х указетель делать преждевременный оптимизация серьёзный средство улучшение удаление:2 большой сам себя причесать полный исходник ваш компилятор отличаться саттер есть весьма подробный эссе тема мелкий подробность затрагивать языковой сторона с++