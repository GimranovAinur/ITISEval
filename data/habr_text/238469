'238469 |@words привет хабра:2 тема мой:2 пост уже:2 подниматься здесь:2 я:5 есть:3 что:11 добавить:2 когда:3 наш:5 файловый:2 хранилище:2 разменять три:2 терабайт весь:6 чаща отдел:4 стать:2 получать:3 просьба выяснить кто:2 удалить:4 важный документ:3 или:2 целовать папка:3 нередко это:16 происходить чей-то злой умысел бэкап хорошо страна должный знать свой:2 герой молоко вдвойне вкусный мочь:8 написать он:2 powershell:3 пока:3 разбираться решить:2 записать:2 для:8 коллега цех потом:2 подумать:2 пригодиться:3 кто-то:5 ещё:5 материал:2 получиться:3 смешанный найти себя:3 готовый решение:2 несколько:2 неочевидный:2 метод работа планировщик:5 задача:6 проверить быстродействие скрипт:12 процесс:2 поиск:2 прочитать статья:4 авторство deks:4 взять основа некоторый момент:5 устраивать во-первых время:6 генерация:2 отчёт:2 четыре час:3 2-терабайтный который:7 одновременно:2 работать:2 около:2 200 человек составить пять:2 минута:3 притом лишний:2 мы:7 лог:3 писаться маленький чем:4 большой:8 хотелось потому:2 во-вторых самый:2 нужно:8 быть:10 реализовать двадцать сервер:2 гораздо менее производительный основной в-третьих вызывать вопрос:2 график запуск:5 в-четвёртых хотеться исключить:2 доставка собранный информация:4 конечный потребитель читать автоматизировать:3 чтобы:4 звонить ход мысль понравиться:2 краткий дискурс при включить аудит система удаление:4 файл:11 журнал:6 безопасность создаваться два:5 событие:15 код:4 4663:2 следом 4660:3 первое записывать попытка запрос:3 доступ:3 дать:4 пользователь:6 путь:2 удалять фиксировать свершиться факт уникальный:2 идентификатор eventrecordid:18 отличаться единица этот ниже привести исходный собирать удалённый:2 time:8 get-date:3 new-timespan:7 -min:3 240:3 events:7 get-winevent:9 -filterhashtable:7 logname=:6 security:10 id=4660:2 starttime=:6 select:13 timecreated:13 запись:7 xml:20 toxml:17 event:44 system:13 _sort bodyl:2 timespan:4 -sec:4 foreach:4 prevevent:9 timeevent:2 timeeventend:5 timeevent+:2 timeeventstart:5 timeevent-:2 body:5 id=4663:3 endtime=:3 _where:6 -match:6 eventdata:12 data:12 name:20 -eq:20 objectname:18 text:19 -notmatch:10 tmp:6 ~lock:6 _select subjectusername:6 secret bodyl= bodyl+ timecreated+ month:2 year:2 deletedfiles- month+ year+ txt outfile:2 serverserverlogfilesdeletedfileslog out-file:9 -append:5 помощь команда:2 measure-command:5 получить:2 следующий select-object:6 totalseconds:6 format-list:3 313,6251476 многовато вторичный долгий сходу очень десятиэтажный пайп:2 поэтому:3 начало:2 структурировать where-object:13 foreach-object:3 уменьшить этажность убрать перечисление:2 заодно:2 сделать:3 более:2 читаемый эффект разница предел погрешность eventid:3 sort-object:3 deletedfiles:10 -and:3 where:9 filepath:2 text':2 username:4 format-table:2 -autosize:2 302,6915627 прийтись немного голова какой:2 операция занимать всего:4 можно:5 натыкать десятка общий-то случай:4 так:5 очевидно тратиться быстрый процедура даже mmc:3 повторяться:2 конвертация тот:2 вовсе необязательно попробовать другой один:2 раз:4 промежуточный переменный:4 id=4660,4663 recordid:14 eventxml:11 timedeleted -hidetableheaders 167,7099384 вот:4 результат ускорение практически порадоваться хватить хороший:2 как:2 запускать ускользнуть появляться делать тогда искать нужный:4 среди тысяча логово:4 мутор писать:2 сутки ротация:3 забыть половина что-то надёжный комментарий говорить:2 приложение дотнуть режим служба знаете разряд there are competing standards задание:2 windows:2 создать:4 триггер:4 системный отлично запускаться ровно создаватие реальный:2 радость неполный если:2 смочь определить хитрость:2 недолгий гуглинга показать передавать исполняемый делаться мягко последовательность действие такой тип:3 экспортировать формат через:3 консоль:2 ветка eventtrigger:3 новый:2 ветвь valuequeries:5 элемент:3 описывать value:2 name=:3 где название передать:3 схема ознакомиться ссылка внизу номер импортировать обратно хотеть:2 натыкивать мышка верно сожаление всесильный командлёт:4 new-scheduledtasktrigger уметь:3 создавать триггера применимый чит-код com-объект достаточно часто приходиться прибегать com хотя штатный каждый версия scheduler:4 new-object:2 -comobject:2 schedule:2 service:6 connect:2 localhost:2 rootfolder:4 getfolder:2 taskdefinition:20 newtask:2 обязательно разрешить одновременный экземпляр также:2 кажется стоить запретить ручной задать лимит выполнение settings:10 enabled:2 true:6 hidden:2 false:6 principal:2 runlevel:2 обычный привилегия:2 повышенный multipleinstances:2 allowdemandstart:2 executiontimelimit:2 pt5m:2 далее задавать xml-запрос:2 получение выбрать необходимый параметр:4 переключиться вкладка trigger:6 triggers:2 create:6 subscription:2 querylist:8 query:8 id=:2 path=:4 provider:2 microsoft-windows-security-auditing:2 and:4 eventid=4660:2 главный указывать собственно описание:2 выполнять action:8 actions:2 path:2 'powershell:2 exe':2 workingdirectory:2 temp' arguments:2 parsedeleted ps1 temp deletionlog log':3 взлетать registertaskdefinition:2 log:4 deleted:2 files:2 'system:2 null:2 концепция поменяться вернуться теперь:4 надо доставать одно-единственный качество аргумент дописать заголовок превращать куча возможный изменять лёт авось cmdletbinding:2 param:2 parameter:5 mandatory=:4 position=1:2 position=2:2 logpath:9 далёкий возникать нюанс сей командлет фильтровать:2 понимать ограниченный набор атрибут входить -filterxml:3 xmlquery=:2 id='0:2 path='security:4 eventid=4663:2 eventrecordid=:2 xmlquery:2 поскольку обрабатываться использоваться только инициировать полезный оно нести помнить без участие узнатьзлодеть какой-либо корень eventline:10 documents:3 подразделение:3 oulogpath:8 -replace test-path:4 deletiondate:4 teventid:4 tusername:4 tobjectpath:4 -filepath:8 итоговый:2 кусочек нарезать остаться:2 собрать воедино чуть-чуть оптимизировать как-то parametersetname='logevent:2 int string psscriptroot:2 parametersetname='install switch install:2 myinvocation mycommand else matches поместить удобный вы место запустить ключ -install сотрудник любой видеть каталог:2 отметить рассматривать право:2 злодей структура файлера тянутый отдельный какой-то степень усложнить строка:2 использовать прекрасный справочник регулярный выражение туториал создание привязать скриптовый api заданийupd опечатка после гравис обнаружение благодарность читатель руслан султанов