'240425 |@words администрирование большой количество чужое сервер:15 влечь себя ответственность защита дать:2 наш:3 клиент что:6 надёжно контролировать список:4 лицо ssh:9 доступ:15 серверов быть:5 решить:3 продумать система:2 авторизация:3 ограниченый набор хост:2 иметь:2 условие задача:3 более 400 физический:4 машина весь:7 клиентский служба храниться виртуальный контейнер openvz основное root:4 закрытый через:4 sudo привилегия есть:3 только:2 админовый:2 несколько принадлежащий компания половина который:3 территориально распределить назвать сделать один шагом:2 управление конфигурация распространить ключ:4 для:4 вход они без:2 пароль:2 каждый:3 админ свой:2 второе закрывать кроме конечно такой:3 схема:2 исключение это:2 индивидуально теперь возникать вопрос безопасность решение:2 люба кто взламывать учеткать получать ограниченный причём очень:2 хорошо:2 мягко выражаться поступить предложение ограничить firewall разрешить сотрудник:2 тут проблема мы:2 мало многий динамический если:2 срочно потребоваться поработать находиться поездка остановиться репорт раз:2 когда определённый логин успешно авторизоваться отсутствовать допустимый redmine:2 падать событие высокий статус далее выяснять произойти применять допрос пристрастие реализация просмотреть текущий готовый аудит ничто подходящий найти или:2 монструозный тот:2 как всегда написать:2 велосипед скрипт:3 анализировать лог предмет успешный:2 брать последний минута:2 сравнивать пара username:2 соответствующий случай:2 проверка нич он делать совпадение отправлять алерт впоследствии становиться python:3 писать два жизнь так замечание код приниматься объективный вид:2 оно работать листинг прилагаться usr bin env import:5 sys time:5 from:4 datetime:3 timedelta:2 date:4 socket:2 hostname:3 gethostname filelist:2 list:2 now minutes=10 strftime commands smtplib:2 def mail:6 message:6 smtp:8 server:2 localhost port:2 user= subject:2 'ahtung security audit alert' example lib:2 msg:3 'from nto ncontent-type text html charset= utf-8 nsubject return-path user:6 sendmail listlog:3 getoutput 'cat var log secure _grep accepted password for:4 awk +date+ print:3 line:8 split:16 matchip:3 matchname:3 curip:2 linels:6 open len strip:4 continue listip:3 break not:4 this:2 found:2 else ahtung:2 logged:2 unknown:2 format +line:3 файл vasya:3 сопутствующий действие поместить cron запуск настроить ежедневный ротация логово полночь отключить больший пароноидальность можно хранить гит раскидывать хук дополнительный относительный плюс этот прийтись увольнять бывать нужно просто убить сессия