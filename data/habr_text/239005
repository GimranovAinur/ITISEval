'239005 |@words здесь продемонстрировать возможность:3 который:9 свой:2 суть самый:4 настоящий хак вопрос:2 зачем это:13 мочь:5 понадобиться:2 дело цель:2 для:23 быть:16 огромный множество итак наш:5 задача:3 изменить:2 код:12 библиотека:8 mscorlib:12 такой:2 образ:3 чтобы:13 весь:12 программа:3 пользоваться получить этот:5 изменение:4 рантайм конечно время старт:2 runtime необходимый:6 проделать:2 другой:5 вещий тут:3 надо:3 оговориться:2 что:16 должный:3 поломать текущий состояние взять как:2 пример:4 потому:3 она:2 есть:3 компьютер можно:3 хакать любой:2 знать:2 тот:9 ад dll:8 microsoft:4 помимо обычный:2 версия:5 название дать:5 подписывать сборка:11 ключ:2 public:12 key:5 гарантировать конкретный:2 пришлый разработчик какой-то:2 поэтому если:4 хотеть вполне добросовестный причина существующий:2 загрузиться чужой процесс:14 при:5 ключик остаться тем:2 мы:14 получиться смочь подписать нет:2 закрытый минь вывести консоль текст:2 начало:2 полный:2 список:4 выложить хабра стать данный цикл делать:2 отгружать взаимодействовать между:3 домен без маршаллинг получение указатель объект:3 net:11 ручной клонирование поток:5 когда:4 assembler или:5 java:2 love системный:3 утечка framework:3 работать:2 декомпиляция продолжать кромсать clr пул вне куча soh loh снимать:2 дамп память:2 приложение:6 краткий содержание введение:2 разработка:5 драйвер:21 вывод:4 написание:2 сервис:11 windows:13 результат:3 исследование сегодня речь пойти находиться gac:4 nac выяснить очень чутко относиться структура:6 доверять настолько загружать оттуда особо проверять:2 номер:4 сделать:2 подмен так:3 много:2 написать уровень:2 ядро перенаправлять:4 обращение:2 определённый файл:4 место воспользоваться:3 filesystem:2 filters простой:3 писать:3 писаться протокол kernel-space:3 user-space:4 сторона выступать service оно:2 общаться давать:2 он:3 команда:5 куда:4 очередь менять:2 например:4 либо:3 reflexil:3 mono:2 _cecil:2 порядок:2 действие получать:3 видоизменить:3 встраивать нея логгирование:2 класть tmp:2 каталог добавлять redirection:7 assembly:2 b77a5c561934e089 mscorlib64 последующий запуск фильтровать также:5 кома:2 конкретно левак оригинальный устанавливать:2 virtualbox отлаживать хотеться перезапускаться каждый раз обращаться адрес вылетать ошибка естественно bsod' виртуалка накатывать x86 x64 снапшота откатываться далее:3 девелоперсковать машина visualddk winddk прочуять инфраструктура сам выкладывать листинг только:3 важный часть:2 minifilter driver:35 регистрация:2 фильтр:4 const:5 flt:6 operation:4 registration:4 callbacks:3 irp:3 create:4 pbpreoperationcreatecallback pbpostoperationcreatecallback network query open pbpreoperationnetworkqueryopencallback null:16 end filterregistration:2 sizeof:14 size:8 version:5 flags:4 context ptfilterunload:3 filterunload ptinstancesetup instancesetup ptinstancequeryteardown instancequeryteardown ptinstanceteardownstart instanceteardownstart ptinstanceteardowncomplete instanceteardowncomplete ptgeneratefilename generatefilename ptnormalizenamecomponent normalizenamecomponent просто:3 вводить:2 volumes перехватывать:2 операция createfile создание:4 открытие инициализация вызывать опытный человек перечислить происходить:2 регистрироваться система:6 делаться нотификация уведомлять новый:3 подниматься communitation port:9 общение пользовательский кольцо защита где:2 ожидать:4 описать ниже:2 cpp entry:23 pdriver object:3 driverobject:2 punicode:7 string:23 registrypath:2 locals ntstatus:7 status:28 attributes attr:3 unicode:4 portname:3 psecurity descriptor:3 securitydescriptor:4 unused unreferenced:2 parameter:2 code:3 try:5 set:2 data:44 zeroes memset setup:2 process:13 creation callback psprocessnotify:2 false:5 success:14 leave:7 setflag:4 initialized:6 filter:8 subsystem:4 get:7 exported functions declare func1:2 ioreplacefileobjectname win7+ pfnioreplacefileobjectname pioreplacefileobjectname mmgetsystemroutineaddress register fltregisterfilter flthandle:4 fltinitializepushlock sync:5 lock security:2 fltbuilddefaultsecuritydescriptor all:5 access rtlinitunicodestring pbcommportname initializeobjectattributes obj:2 case:2 insensitive kernel handle:5 fltcreatecommunicationport:2 connection:2 serverport commportconnect commportdisconnect commportmessagenotify comport free the:2 cases not:8 needed:3 once call made fltfreesecuritydescriptor start:4 filtering fltstartfiltering assert state:2 started:2 finally:4 deregisterfilter:3 return:14 выход сказать заниматься:2 освобождение ресурс основываться выставить флаг:2 выше unload paged dbgprint:8 policiessandbox entered теперь:2 какой небольшой протокольчик kernel-mode user-mode:2 communication оторый поднять driverentry определять:3 набор:2 typedef:6 enum from:10 verson getversion getfilesystemredirections addfilesystembypidredirection removefilesystembypidredirection getregistryredirections addregistrybypidredirection removeregistrybypidredirection processattached:8 canceliocompletionport:3 here comm:5 command:13 база struct:6 ushort:10 message:24 pcomm:9 посылать:2 уведомление ulong:6 pid:20 attached:3 опеделять структура-ответ needtomonitor:6 iscompleted true:6 this:2 packet contains:2 redirections:23 otherwice needs ask more:3 pairscount:4 count:5 actually null-terminated strings positions:10 make:3 searching fast wchar:7 хранение mapping:11 oldname:13 newname:10 next:8 pmapping:6 processes:4 map:10 entries:3 prev:3 pprocesses:5 определить новое уже оповестить качество:2 ответ:2 отдать правило:5 редирект:6 папка:3 зависимость включать:2 функция:4 очищать интересно вызов передаваться создать:4 умирать оповещать:3 смерть внутри создаваться передавать:2 находить себя отдавать void:5 parentid processid:9 boolean handletoulong:6 check exsisting large integer litimeout:3 created quadpart longlong 1000:2 senderbufferlength:2 buffer:18 replylength:3 mynonpagedalloc:2 message-:3 fltsendmessage clientport recieved:3 reply:8 redirections-:12 pbrepinitializemapping:5 else:5 thread:18 monitored skipping:2 myfree destroyed while:6 entry- pbrepdeletemapping break представить инициализировать внутренний:2 относительно прислать fltacquirepushlockexclusive plociessandbox:3 current:9 lookup currentprocess:9 currentprocess-:9 already mapping- for:9 int:11 i=0:2 i++:2 copying pair pathes:2 from- internal structure fromlen:2 wcslen:5 tolen:2 mappingentry:4 myalloc:3 nonpagedpool:3 mappingentry-:10 wcscpy:2 length:14 maximumlength:2 current-:14 fltreleasepushlock:2 done последний поиск найти возвращать путь bool:3 pbisfolder:2 path:4 path-:2 pblookupredirection filepath out:9 filefound:3 possible full change:2 device:6 harddiskvolume2:5 internalpath:4 some:3 file:4 ext:4 temporary:3 partial starts with should:3 changed psgetcurrentprocessid fltacquirepushlockshared folders prefixes are:2 identical please note that lengthes double-sized wcsncmp filepath-:5 newlength:2 ret:6 pballocunicodestring:2 rtlcopyunicodestring:2 rtlcopymemory add2ptr:2 ret-:4 wcscmp found внешний операционный информация принимать решение немой:2 мониторинг файловый опять вдаваться особый подробность единственный особенность заключаться отвечать они:2 помощь iocompletionport механизм требовать общий понятно ожидание завершение:2 ввод порту висеть:2 несколько прийти один просыпаться обработать отсылать немного нечистый ладный главный filterconnectcommunicationport:2 соединять createiocompletionport:2 создавать completion:5 ссылка почитать messagingmanagerthread:7 класс:2 управлять обработка сообщение остановка stop:2 через иначе unsafe:7 class:3 messagingmanager:2 private:16 filtercommunicationportname:4 policiesinjectorcom0 intptr:16 filterporthandle:12 iocompletionporthandle:10 buffers:5 threads:8 cancellationtokensource:2 cancellationtoken:6 dictionary:3 uint:6 winapi:24 zero:6 0x0 throw:6 createwin32exception:6 format:3 can:5 connect via console:20 writeline:18 connected info:2 eng http:3 msdn:2 com:3 en-us:2 library:2 desktop:2 aa365198:2 v=vs:2 aspx:2 rus www:2 rsdn:2 article:2 baseserv:2 threadpool:2 xml:2 threadscount:5 environment:4 processorcount completeon each processor and:2 cancellation:3 token:4 new:10 number monitor marshal:6 allochglobal f2u:9 incomingmessagepacket:8 rtlzeromemory:2 var:13 street magic see ddk:2 examples-:2 mini:2 filters-:2 scanner:2 filtergetmessage:2 buffer-:2 header:6 typeof:2 ref:6 overlapped:5 hresult:2 win32:3 error:9 pending:2 successfull:4 cancel:3 starting:2 cancelioex errstr:3 operations getlastwin32error:2 foreach:4 asenumerable:2 completionkey:2 postqueuedcompletionstatus nativeoverlapped:2 waithandle:3 waitone 2000 failed waiting:2 stopped threadid:9 todo kill report confusing bug наконец обслуживание manualresetevent:2 resetevent:4 canceltoken:3 int32:2 timeoutcompletionstatus 5000 summary:2 builds param:2 name= unmanaged getcurrentthreadid monitoring messages processing queue:2 requested:3 iscancellationrequested otherwise read numberofbytestransferred:2 uintptr lpcompletionkey:2 lpoverlapped:3 getqueuedcompletionstatus:4 something wrong happend aborted wait timeout time continue:2 returns finished successfully request:5 request-:6 run:2 destroying gettype:2 send signal owner data-:2 incoming incomingmessagepacketreply messageid:2 size= max pattachedreply processattachedreply:3 pattachedreply-:9 needtomonitor=1 getprocessbyid retrieved name managed processname:2 catch argumentexception needtomonitor=0 testredir:4 needtomonitor==1 pos:5 index:3 registered trying add:2 value:2 unchecked appendstringtoarray:3 index++ filterreplymessage making replystat=0x arr:3 str:2 position:3 position++:2 настройка следующий хитрый redir:2 redirectionsmanager getname temp:2 gac32:2 значит привести 32-ха разрядный:2 64-ха тоже модифицировать модификация reflector старое freeware заменить system:3 40930:2 проверка тестирование назвать поскольку:2 именно имя невозможностиusing namespace static:2 main args ver:2 write press any readkey заметка изменять аккуратно валита программный обеспечение запускаться хороший послужить логгера событие чем сейчас источник fsfilters blogspot