'242741 |@words дать статья:4 для:17 виртуализация использоваться:3 kvm:2 libvirt:2 сразу отметить столько сколько именно особенность преимущество использование open:4 vswitch:4 объединение виртуальный:8 физический сетевой:10 устройство:3 посредством:2 технология vlan:16 802:3 былинный время проброс тегированный трафик гипервизора:2 всевозможный костыль подпорка различный степень неожиданность tuntap brctl:2 vconfig ebtables прочее что:7 приводить захламление операционный:2 система:5 хостящи больший количество ненужный:2 интерфейс:12 мозолить глаз вывод:2 ifconfig:8 вообще:4 огорчать администратор необходимость:2 строить стандартный:4 коммутатор:10 отдельный часть как:8 какой-то велосипед помимо поддержка самый:2 дело сегодня требоваться ещё:6 много функция так:3 максимально соответствующий:5 функционал современный управляемый привести появление проект:3 далее ovs:9 рисунок:6 песочницын кдпть изобразить:2 юзкейс построение песочница:4 подготовка замена:2 наш:9 устаревший vpn-маршрутизатор:4 новое:2 нужно:3 сконфигурировать аналогично уже:2 инсталлировать компания тот:5 адрес правило фильтрация настройка:3 динамический маршрутизаци протестировать весь:6 эмулировать isp через:2 который:3 соединяться сайт локалка повториться этот:7 сложность подключить:4 уютный частность начать:2 начало установить:2 чистый копия ubuntu-14 1-server-amd64 опция virtual:2 machine host после установка:2 иметь следующий вид:2 утилит просмотр параметровroot sandbox:12 _grep:5 -ve:3 'rx_tx_coll_inet6_mtu'eth0:3 link:13 encap:13 ethernet:10 hwaddr:10 00_1b_78_9c_2b:5 inet:14 addr_10:3 bcast_10:3 255:40 mask_255:9 local:3 loopback:5 addr_127:3 virbr0:5 1a_70_19 e9_3c addr_192:3 168:11 122:11 bcast_192:3 0root:2 route:2 -nkernel:2 routing:2 table:2 destination:2 gateway:4 genmask:2 flags:2 metric:2 ref:2 use:2 iface:7 254:6 eth0:20 192:2 virbr0root cat:2 etc:3 network:11 interfaces:4 auto:5 static:2 address:3 netmask:2 broadcast:2 dns-:2 options:3 are:2 implemented:2 the:2 resolvconf:2 package:2 installed:2 dns-nameservers:2 root:5 virsh:9 net-list all name:6 state autostart persistent default:5 active yes:2 yesroot net-dumpxml uuid:2 865fd53b-5bd5-430c-b7c7-664125dee9f6 forward:3 mode='nat nat:2 port:11 start='1024 end='65535 bridge:8 name='virbr0 stp='on delay='0 address='192 netmask='255 dhcp:2 range start='192 end='192 showbridge stp enabled 8000 000000000000 очень стандартно необычный картинка:2 простой начальный состояние:3 системыустанавливать openvswitch:2 apt-get install openvswitch-switchпосле он:7 какой:2 изменение:2 параметр:4 происходить лишь:2 запускаться сервис ждать:2 распоряжение быть:5 заставлять вводить нижеприведенный команда:6 консоль или:2 помещать временный скрипт:2 запускать ovs-vsctl:13 add-br:2 ovs-br0:23 set:5 tag=7 add-port:4 trunks=7,10,20,1010,1020,30,1030 add:2 via:2 переключать:2 хост:2 тегировать:2 порт:13 коммутаторапоясненияovs-vsctl ovs-br0создавать почти пустой инстанс есть:2 только:2 один:5 одноимённый внутренний:2 tag=7конфигурировать access-port eth0добавлять trunks=7,10,20,1010,1020,30,1030делать транков указанный принцип trunks:3 можно:4 указывать тогда пропускать 0обнулять конфигурация:5 большой связать стек upвместо стечь:2 прикручивать 254н забывать восстановить таблица маршрутизациипереключать коммутаторама сеть:3 смотреть измениться настройкахroot show40952e4d-81ad-433b-b08b-f88ccd55f26a:2 tag:10 interface:10 type:2 internal:2 7,10,20,1010,1020,30,1030 version:2 dd_38_09:2 virbr0н вместо:3 дальнейший изображать мы:2 интересный влиять ничто:2 неожиданный логично интуитивно понятно приятный момент:2 кто беспокоиться где размещать стартовый применение особо делать прийтись вышеуказанный:2 применяться автоматически сохраняться вы переживать несовпадение текущий сохранить файл:3 надо малость обновить связь manual данный всего два:4 машина:3 тут минимум путь наиболее очевидный состоять чтобы помощь:3 добавить:2 access транковый выбор vlan10:2 tag=10 type=internal чёрточка выполнение несколько строкузатем прямо gui:2 virt-manager':3 выбрать подключение:2 пойти более масштабировать способ при:3 это:2 создавать собственно:2 linux:2 core создать:2 порт-группа:5 каждый предназначить сожаление недоступный необходимый:2 вручную подготовить простенький xml:3 описывать затем применить api указать ниже xml-конфига показать ovs-network:9 mode='bridge name='ovs-br0 virtualport type='openvswitch portgroup:11 name='vlan-10 id='10 name='vlan-20 id='20 name='vlan-1010 id='1010 name='vlan-1020 id='1020 name='trunkportgroup trunk='yes id='30 id='1030 выполнять tmp:4 net-define:2 net-start:2 net-autostart:3 ovs-networkпоясненияvi xmlкопировать содержимое xmlvirsh xmlконфигурировать новый kvmvirsh ovs-networkзапускать ееvirsh ovs-networkделать запуск автоматическимчто удалить net-destroy disable net-undefine получить рисунок4 vmсоздать пара:3 vm1 vm2 создание укажим advanced 'ovs-network пока оставить выключить подправить конфига виртуалокvirsh edit vm1найти секция type='network mac address='52_54_00_5e source network='ovs-network portgroup='vlan-10 model type='virtio type='pci domain='0x0000 bus='0x00 slot='0x03 function='0x0 сделаеть если посмотреть сейчас увидеть произойти добавиться:3 лишний появиться теперь запустить:2 оба раз проверить хостаroot vnet0:3 1010 1020 1030 vnet1:3 fe_54_00_5e fe_54_00_7f_40 видеть mac-адрес выключение опять исчезнуть vmещё упомянуть единственный фич организовать например бондинга кое-что вот надеяться кто-то помочь решиться использовать свой просто