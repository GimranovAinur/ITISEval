'246841 |@words периодически как:12 правило два:5 среда месяц можно:7 услышать история:2 тот:10 что:23 windows:10 после:3 очередной обновление:2 переставать загружаться показывать синий:2 экран:2 смерть большинство случай:3 причина:2 такой:5 ситуация оказываться либо:2 руткит:5 специфичный:2 системный:7 фривольно обращаться внутренний структура:9 винить конечно весь:12 равно ведь он:7 работать:4 отношение удивительно майкрософт поощрять использование:3 всего документировать какой-то момент:2 именно:3 релиз server 2003 занять более:2 активный позиция вопрос борьба чудо-поделка сторонний разработчик:3 тогда появиться:2 механизм:2 защита:2 целостность:5 ядро:16 kernel:6 patch:5 protection:3 известный patchguard:22 самый:8 начало:2 позиционироваться поскольку:4 привилегия следовательно мочь:2 быть:20 обезвредить это:6 скорее фильтр отсекать ленивый охранять:2 популярный:2 место:3 модифицирование:2 таблица:9 вызов:5 при:12 помощь:3 модификация указатель:4 функция:38 легко перехватывать:2 фильтровать логировать причём:2 этот:4 патч:4 для:18 так:5 антивирусный другой интересный:2 объект:2 дескриптор:6 gdt:2 idt:2 через:9 глобальный:2 изменять атрибут сегмент создавать:4 бекдора код:7 прерывание:5 продвинуть парень сплайсиль непосредственно:2 соответственно один:8 версия:3 защищать:4 sst образ:8 ядерный стечь развитие перерабатываться множество:2 компонент число:3 текущий уже сложно перечислить защищаться только:2 hal:2 werlivekernelapi clfs pshed kdcom bootvid msrpc ndis ntfs tcpip fltmgr критически важный дать:7 например:3 список процесс набор msr model specific регистр:2 ia32 lstar kdpstub процедура:3 отладчик:3 получать управление исключение:9 стоить отметить активно использовать:5 новый:4 реализация обработка:2 ввести x64-версия использоваться:3 обфускация проверка:27 предыдущий:2 обработчик:4 прямо:2 стек:6 даже:3 позволять обходить stack cookies эксплуатация уязвимость основный изменение:2 заключаться хранение специальный внутри:5 исполняемый запись каждый:3 отдельный:4 typedef struct image:2 runtime:3 function:3 entry:3 uint32:4 beginaddress начать:2 endaddress конец:3 union unwindinfoaddress раскрутка:2 unwinddata pimage счёт адрес:3 люба получить рантайм задача подсчёт:2 контрольный:5 сумма:5 отдельно взять становиться:2 тривиальный сравнение x86-версия контроль невозможный из-за:2 непонятно определить граница целиком или:2 секция:2 накрывать нельзя присутствовать который:16 патчиться сам:2 лёт загрузка:2 контекст:26 храниться:2 копия:2 ключ шифрование неподкачивать пул зашифровать вид поговорить чуть поздний инициализироваться:2 фаза заниматься:2 создание:3 иметь:2 публичный:2 символ:2 называть kiinitializepatchguardcontext:4 найти:3 kifilterfibercontext:12 возможно call:6 phase1initializationdiscard:3 keinitamd64specificstate:3 exception sub:2 14071815c:2 explicensewatchinitworker:2 вариант:3 всегда хотя время:3 также:2 примечательный тем:2 вызывать:3 неявно вброса псевдокод:4 int64:2 signed int edx result:7 rax безопасный режим initsafebootmode:2 ror4 kdpitchdebugger:2 kddebuggernotpresent:3 отсутствие деление:2 вызвать:2 переполнение раз return:2 очевидно:3 связать лицензия explicensewatchinitworkervoid pvoid:3 kifilterparam:4 ntstatus pfilterparam boolean:2 forgetaboutpg:4 kiservicetableslocked:2 kiinitialpcr:4 prcb:8 halreserved:6 null:2 kuser shared data kddebuggerenabled rdtsc:7 100 kebugcheckex system license violation 0x42424242 0xc000026a ниже привести:2 выбирать способ:2 конкретный:2 вызывающий kifilterfibercontextboolean pkifilterparam:3 true:2 dword64:5 dwdpcidx1 выбор:2 dpc:10 осуществляться dwrand2:3 создаться dwmethod1:4 метод:4 запуск antidebug:2 dwdpcidx dwdpcidx2:2 dwmethod2:4 while false обфусцировать настолько автоматический средство она:2 справляться исследователь внезапно неинтересно реверсить:2 статика полный каша 10k+ строка:2 декомпилировать лоб декомпиляция ida pro занимать около минута:3 говорить обширный макрос:2 простой операция взятие случайный:2 размазать 50+ ассемблерный цикл:2 развернуть вставить:2 много мёртвый косвенный обращение переменный:2 внешний динамик тоже довольно непростой вот:2 пара пример:3 рассыпать cli:2 xor eax:2 cmp byte ptr:4 jnz short:2 loc:2 140f3cfbd jmp 140f3cfbb sti:2 делать:2 антиотладочный:2 трюк:2 подключить входить бесконечный непрерываемый sidt fword:3 rbp+320h:2 lidt:2 rbp+228h mov dr7 r13 загружать временной невалидный если:6 следить доступ отладочный:2 произойти условие:2 tripple fault последующий перезагрузка рассмотреть параметр:5 индекс следующий kitimerdispatch kidpcdispatch exptimerdpcroutine:2 ioptimerdispatch:2 iopirpstackprofilertimer:2 popthermalzonedpc:2 cmpenablelazyflushdpcroutine:2 cmplazyflushdpcroutine:2 kibalancesetmanagerdeferredroutine:3 exptimerefreshdpcroutine:2 exptimezonedpcroutine:2 expcenturydpcroutine:2 планирование:3 kesetcoalescabletimer:2 создаваться:4 таймер:4 запустить:3 2м_05с:6 acpireserved:2 сработать:4 определённый:2 acpi событие переход состояние:2 низкий энергопотребление ранний:3 чем:4 тик pscreatesystemthread:2 поток:5 спать:2 вызываться keinsertqueueapc:2 regular apc срабатывать сразу ждать work:2 item:2 kibalancesetmanagerperiodicdpc:2 менеджер балансировка назначение ясно известно лишь влиять количество выбрать сообщать необходимость пересчёт себя смотреть являться:2 deferredcontext:2 неканонический:3 память порядок выполнять свой:2 законный:2 работа иначе цепочка рекурсивный:2 приводить конечный итог разыменовывание исполнение последовательность зависимость dpc-функция kicustomaccessroutine0 kicustomrecurseroutine0 kicustomrecurseroutinen:10 kicustomaccessroutine1 kicustomrecurseroutine1 kicustomaccessroutine2 kicustomrecurseroutine2 kicustomaccessroutine3 kicustomrecurseroutine3 kicustomaccessroutine4 kicustomrecurseroutine4 kicustomaccessroutine5 kicustomrecurseroutine5 kicustomaccessroutine6 kicustomrecurseroutine6 kicustomaccessroutine7 kicustomrecurseroutine7 kicustomaccessroutine8 kicustomrecurseroutine8 kicustomaccessroutine9 kicustomrecurseroutine9 состоять этап:2 сперва происходить dpc-уровень затем планироваться осуществлять:4 удачный старый удаляться вместо интервал:2 удаться зачищать след зануляй демонстрировать ошибка 0x109 critical structure corruption гифка саморасшифровываться первое победить существовать несколько подход обезвреживание чтобы вообще хук kebugcheck восстановление система отмена запланировать:2 реализовать мы:2 понравиться последний чистый ничто нужно хукать пачтить необходимый:3 просто:4 заменить значение некоторый просканировать:3 содержимый увеличить ожидание бесконечность:2 занулить:2 данный:2 пол:2 раскрутить упираться наш клиент выставлять спячка равный рабочий:2 встречаться кодовый раскручиваться fsrtlmdlreadcompletedevex fsrtluninitializesmallmcb точно обезвреживать восстановить действие успеть совершить описать выше результат никогда осмотр technical preview заметить небольшой старое остаться прежний однако:2 пока безусловно возвращать status feature unavailable немного покопаться обнаружить kiswinterruptdispatch явно идти расшифровка:2 добавить возможность запрос гипервизора:2 hyper-v приходить синтетический проверять продолжаться статья стараться указывать имя:2 потому жалко намеренно изменить меняться разный несоотвтествие название действительно саморасшифровка хорошо находиться ряд они лежать файл исходный ограничиваться различный часть иной приходиться искать вручную ccinitializecachemanager ccinitializebcbprofiler вероятность произвольный планировать ccbcbprofiler удача поиск весело ссылка frequently asked questionsbypassing x64patchguard reloadedtss blog patch-guard 1the protectionunderstanding and defeating protectionmicrosoft analysis attack vectors