'247273 |@words время:3 публикация один:11 часть:4 статья:2 глобально мир ничто измениться земля наскочить небесный ося весь:14 так:7 расти популярность облачный сервис гипервизора:11 компания microsoft:3 быть:17 обнаружить новое дыра исследователь хотеть тратить свой:7 поиск:4 баг плохо документированный мало изучить:2 технология:2 поэтому:3 предлагать ты:2 освежить память:5 частью предыдущий:2 номер:4 пополнить запас бар приступить чтение:2 ведь сегодня сделать:2 драйвер:13 взаимодействовать интерфейс:4 отслеживать передаваемый:2 гипервизором:4 сообщение:34 также:5 работа:5 компонент:12 служба:2 интеграция:2 data:9 exchange:8 обработка:8 dvd xakep выложить написать:2 помощь:7 visual studio 2013 должный загрузить:2 root:18 например:4 osrloader для:24 отправка:4 ioctl-код:2 использоваться:2 простой программа sendioctl exe после:15 interrupt:2 code начинать выполнять:7 дать:14 передать:5 через:6 нулевой:4 слот:6 sim:9 сожаление:2 переменный:4 hvlpinterruptcallback:6 который:15 содержаться:2 адрес:11 массив:7 указатель:7 обработчик:12 ядро:5 экспортироваться обнаружение необходимый:8 проанализировать:3 код:7 экспортировать:2 функция:31 hvlregisterinterruptcallback:6 содержимый:4 мы получиться:2 просто вызвать:2 регистрация:2 как:5 самый:2 начало:2 идти проверка:3 значение:18 hvlpflags если:12 равный:5 присваиваться это:18 начальный этап:2 загрузка прекращать выполнение:7 возвращать:2 ошибка 0xc00000bb status:2 not:2 supported соответственно:4 происходить:4 замена:4 прийтись вариант:2 hyperv4:2 действие выполняться:6 registerinterrupt:3 int:2 unicode string uniname:3 pvoid pvhvlregisteraddress:5 null:9 physical:2 address:6 padr:5 ulong:2 processorcount:4 получать:6 число:3 активный:5 процессор:4 kequeryactiveprocessorcount dbglog:9 active processor:2 count rtlinitunicodestring mmgetsystemroutineaddress dbgprintstring:8 can find return:6 dbglog16:4 findhvlpinterruptcallback unsigned char производить оригинальный:4 archmhvlregisterinterruptcallback:5 uintptr:10 archmwinhvoninterrupt:3 pvhvlpinterruptcallbackorig:5 win interrup index:5 archxpartenlightenedisr:6 xpart:4 enlightened:4 isr0 isr1 isr2 isr3 simp:2 разный:2 получить:3 физический:3 warning эксперимент связанный интенсивный виртуальный:6 машина:5 хороший:2 заменять поскольку:3 сразу:2 приводить нестабильный система:2 крайний мера при:13 большой:3 поток отладочный:3 kdprint wpp возможный доступ содержимое:2 страница:8 смапировать mapiospace сохранить каждый:5 последующий использование:2 for:2 i++ kesetsystemaffinitythreadex 1i64 current number kegetcurrentprocessornumberex:2 quadpart:2 archreadmsr:2 x64:5 msr:2 0xfffffffffffff000:2 pvsimp:9 mmmapiospace:4 page:2 size:3 mmcached:2 error:2 during:2 siefp pvsiefp:5 рис:41 изменить:2 заменить:2 одновременно выглядеть:2 следующий:5 образ:7 выполнить:6 аналогия четыре:3 vmbus:13 процедура:3 сохранение:2 регистр:3 стек:3 передавать:2 управление:3 парсинга:3 parsehvmessage:2 parsevmbusmessage:2 mpushad mpopad макрос передаваться:6 winhvoninterrupt:2 xpartenlightenedisr:3 void:2 phv:6 message:8 phvmessage:6 phvmessage1:2 логический:3 ucurprocnum:4 unlock+0x162 vmbkmcl:4 vmbchannelenable+0x231 pipestartchannel+0x9e pipeaccept+0x81 instancecreate+0x90 iopparsedevice+0x7b3 obplookupobjectname+0x6d8 obopenobjectbyname+0x1e3 iopcreatefile+0x372 ntcreatefile+0x78 kisystemservicecopyend+0x13 ntdll ntcreatefile+0xa kernelbase:2 createfileinternal+0x30a createfilew+0x66 vmbuspipe:2 vmbuspipeclientopenchannel+0x44 icsvc:7 ictransportvmbus _clientnotification+0x60 vmbuspipeclientenumeratepipes+0x1ac ictransportvmbusclient _open+0xe5 icendpoint _connect+0x66 icchild:3 _run+0x65 ickvpexchangechild _run+0x189 _icservicework+0x137 _icservicemain+0x8f активировать активация:4 свойство:2 нажатие кнопка apply гипервызов:2 hvpostmessage:3 отправлять:3 гостев:20 channelmsg:9 offerchannel guid:2 устройство:3 являться:2 дочерний:2 отношение далее:7 гостевой:2 обрабатывать:3 вызывать:7 instancedevicecontrol вывод:4 devnode windbg:14 call:2 sitent ioallocatemdl:2 instanceclosechannel+0x22d возврат:2 имя:3 отсутствовать:2 символ:2 instancedevicecontrol+0x118 kmclpsynchronousiocontrol+0xa7 kmclpclientopenchannel+0x2a6 kmclpclientfindvmbusand else уведомление:3 1-й puint8 sint1:2 phvmessage1- header:10 messagetype:5 зависимость тип:7 структура:9 описать tlfs switch phvmessage-:3 case:5 hvmessagetypex64ioportintercept printioportinterceptmessage break:6 hvmessagetypenone:2 hvmessagetypex64msrintercept printmsrinterceptmessage hvmessagetypex64cpuidintercept printcpuidinterceptmessage:3 hvmessagetypex64exceptionintercept printexceptioninterceptmessage default unknown считывать:3 сперва производиться анализ тело:3 dbgview:3 можно:7 увидеть:4 картина обращение msr-регистр пример:5 разобрать openchannel:4 gpadl:4 исходный lis формат без труд:2 дописать шина обычно генерироваться включение:4 выключение или:4 integration services:2 отладчик показать:2 информация:2 изобразить exchangeintegration рассмотреть какой обмен:2 между:2 этот:8 позволять определённый ветка:2 реестр:2 создать:2 hkey local machine:2 software virtual:2 guest ключ:6 kvpdatavalue:2 получение использовать:3 powershell-скрипт:2 powershellскрипт запрос скрипт:4 вернуть kvpdatakey:3 доступный набор getrelated msvm kvpexchangecomponent guestexchangeitems только:3 разбор объект предмет работать тот:5 случай:8 вызываться:4 размер:6 выделять буфер:8 0xc000:3 результат:9 сформировать mdl:9 mmprobeandlockpages завершение:2 дополняться элемент:2 pfn:27 выделить:2 непрерывный область:3 хотя условие:2 необязательно chcreategpadlfromntmdl второе параметр:8 chpcreategparanges качество:3 первое копирование:3 отдельный:3 стать посредством вызов:5 chsendmessage winhv:2 winhvpostmessage mdlструктура участок отвечать байт общий:4 заголовок:2 где 0xf0 внутри размещаться vmbus-пакет указанный:2 пакет:2 rangecount что:12 следовать вместиться объём разделить отправить:3 слать:3 result:2 затем:2 отрабатывать workitem-процедура chmapgpadlview ход vmbusr:14 chmapgpadlview- pkparsegparanges очередь:3 xpartlockchildpagessynchronous- xpartlockchildpages vid:5 sys:5 неизвестно два блок:5 ранее:3 непосредственно:2 rsp+30h находиться:3 вновь процесс завершаться такой:5 создаваться:2 некий shared-буфер:2 видимый проверить запись произвольный команда 2d5bb000:3 aaaaaaaa посмотреть соответствующий возвратить 1367bb000:3 видно:3 совпасть действительно вспомнить определить порт:2 hvporttypeevent targetsint операция:2 kivmbusinterrupt1 она:2 keinsertqueuedpc dpc:2 он ставить parentringinterruptdpc несколько:3 pkgetreceivebuffer:3 child-sp retaddr site fffff800:12 fcc1ea38 6cdc440c pkgetreceivebuffer+0x2c fcc1ea40 6cdc41a7 pipetryreadsingle+0x3c fcc1eaa0 6cdc4037 pipeprocessdeferredreadwrite+0xe7 fcc1eaf0 6c96535e pipeevtchannelsignalarrived+0x63 fcc1eb30 6cdc4e3d vmbkmclr kmclpvmbusmanualisr+0x16 fcc1eb60 fb2d31e0 parentringinterruptdpc+0x5d просмотреть становиться видный ffffd0016fe33000:3 l1000 ffffd001:19 6fe35b30:2 0065004e 00770074 0072006f 0041006b 6fe35b40 00640064 00650072 00730073 00500049 6fe35b50 00340076 00000000:19 6fe35d20 6fe35d30 00300031 0030002e:2 0033002e 6fe35d40 pte:9 ffffd0016fe35b30 pxe:4 fffff6fb7dbedd00:4 ppe:4 fffff6fb7dba0028:3 pde:5 fffff6fb74005bf8:4 fffff6e800b7f1a8 contains:16 0000000000225863:4 00000000003b7863:4 000000010fb12863:4 80000001367bd963 225:4 -da:9 kwev:9 3b7:4 10fb12:4 -da-kwev:3 1367bd:2 -g-da:4 kw-v:4 3-й конвертировать rdx:2 смещение:2 относительно 4448h произвести:2 pkgetreceivebuffer+0x4e mov r10 r10d add:2 qword:2 ptr:2 rcx+20h:2 rcx+20 ffffd0016ff22448 fffff6e800b7f910 80000001367c0963 1367c0 поставить:2 точка:3 останов:3 начать выполнимый сработать rcx rcx+18:2 poi evaluate expression -52770386006016 6fe33000:3 fffff6fb 7dba0028 fffff6e800b7f198 80000001367bb963 1367bb cr3 cr3=00000000001ab000 vtop 1ab000:2 ffffd 0016fe33000 amd64vtop:6 virt pagedir pml4e 1abd00 pdpe 225028 3b7bf8 00000001:4 0fb12198 mapped phys 367bb000 translates info kvp найти блог msdn goo r0u52lgoo uezrk2 инструкция:7 итерация 6ff21d10 6ff21d20 6ff21d30 00020006 00000148 00000 a28:2 00000003 00050002 0a140000 00000515 00000103 6ff21d40 00000004 00000016 0000001a 6ff21d50 0076004b:2 00440050:2 00740061:2 004b0061 6ff21d60 00790065 6ff21f50:2 00560061 6ff21f60 006c0061 00650075 ffffd0016ff21f50 fffff6e800b7f908 80000001367bf963 1367bf pipetryreadsingle копировать memmove задать:2 чем 4000h лишь считывание принцип:2 привести:2 значительный снижение производительность перехват:7 настроить чтобы:2 cpuid:10 0x11114444:6 hyper-v предоставлять вид hvinstallintercept реализовать setupintercept:2 список идентификатор winhvinstallintercept:3 intercept:5 descriptor:5 parameters:5 hvstatus:7 partition:3 partid:3 0x0 nextpartid:7 rax-инструкция родительский раздел:2 setupinterception was:2 called cpuidindex type hvintercepttypex64cpuid winhvgetpartitionid winhvgetnextchildpartition child access mask execute while invalid eax:2 rax:2 longmode записывать пол defaultresultrdx:4 расположить 0x12345678 hvmessage phvcpuid ntercept hvmessage- payload phvcpuid-:12 defaultresultrax:2 defaultresultrbx:2 defaultresultrcx:2 =0x12345678 rip:2 interception handled запустить тестовый утилит:2 установка:2 вывести:2 отобразить обычный установленный:2 стоить обратить внимание трюк пройти установить hyperv перейти winhvr winhvcreatepartition создание мочь изменение наш:2 разумеется исправить заключение несмотря прочтение мой твой мозг наверняка встать поза речной скорпион вообще досюда дочитать респект редакция отвлечься скорее обзорный демонстрировать некоторый виртуализация однако надеяться помочь понять позволить более глубоко безопасность автор gerhart впервые опубликовать журнал хакер:4 2014 подписаться бумажный ios ipad android