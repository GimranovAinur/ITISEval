'245847 |@words девять версия:5 postgresql:8 для:10 создание:3 тёплый резервный:22 сервер:29 использоваться wal:18 archiving:2 появиться:3 потоковый:2 репликация:11 возможность горячее read-only следующий новый функционал под:2 название replication:12 slots:5 рассмотреть:2 что:5 себя представлять чем отличаться предыдущий способ сегодняшний момент доступный один кандидат релиз качество тестовый:4 стенд выбрать виртуалка ubuntu процесс:4 сборка установка одинаковый основный:9 ставить исходник предварительно поставить необходимый:2 пакет:2 sudo:17 apt-get:2 update install make:2 g++ checkinstall:2 libreadline6-dev zlib1g-dev скачивать распаковывать архив репозиторий wget https ftp org:2 pub source 4rc1:4 postgresql-9:3 tar:3 xzf собирать устанавливать configure умолчание:2 бинарник работа субд ставиться usr:9 local:9 pgsql:9 добавить:3 пользователь:3 postgres:56 система:4 useradd создать:8 директория:6 кластер:10 mkdir:3 data:16 chown:2 chmod:3 0700:3 далее выполнять действие основное:9 инициализировать bin:8 initdb:2 кроме структура дефолтный конфига:3 log:8 который:6 быть:4 храниться лог:4 запись hba conf:5 подключение:2 чтобы мочь забирать wal-лог:7 host:3 all:2 192:7 168:8 md5:6 replica:7 108:4 править параметр:6 listen addresses слушать входящая соединение:2 весь:4 интерфейс level hot:2 standby:5 формат wal-логово:8 max senders количество:7 одновременный logging collector:4 складывать запускать:2 наш ctl:2 start:4 смотреть состояние:6 aux grep 21295:2 23700:3 604:2 13_39:12 0_00:17 logger:3 process:19 21297:2 170880 138408 0_01 checkpointer:4 21298:2 170784:2 51076 writer:5 21299:2 170648:2 5148:2 21300:2 171052:2 1836 autovacuum:2 launcher:2 21301:2 25924:2 1060:2 0_17 stats:3 право psql:3 create:4 user with encrypted password '123 база дать:6 createdb testdb:3 table testtable:5 serial text insert:6 into:4 select:8 nextval:4 'testtable:4 seq:4 _regclass:4 generate:4 series:4 1,1000000:3 _text:4 настроить при:4 помощь:3 утилит basebackup:3 сделать копия:2 103:3 копировать содержимое:2 включая поэтому:4 изменять файл:4 recovery:2 указать mode='on primary:4 conninfo='host=192 port=5432 user=replica password=123 после:4 это:6 должный запуститься sender:2 receiver:2 скрытый текстpostgres 170756 2312 2252 1804 21323 171048 2108 13_46:7 56673 streaming:6 4e000210 15150 612 15151 170788 1496 startup recovering 00000001000000000000004e 15152 170680:2 944 15153 1204 15154 25792 648 15155 174956 1660 4e000138 посмотреть:4 можно:2 через представление stat:3 testdb=:11 from:6 record:6 pid:2 21987:2 usesysid:2 16384:2 usename:2 application:2 name:4 walreceiver:2 client:6 addr:2 hostname:2 port:3 56674:2 backend:4 2014-11-25:2 18_30_09:2 206434+03:2 xmin:4 state:4 sent:2 location:8 5a2d8e60:4 write:2 flush:2 replay:2 sync:4 priority:2 async:2 видно основной:4 синхронизированный теперь:3 сгенерить:3 ещё:3 немного сразу 1000000:2 63800000 63680000:2 6136e160 здесь наблюдать:2 забрать:4 успеть:2 применить отставать происходить асинхронный бинарный фиксировать размер:2 16мба находиться xlog:4 менять checkpoint:5 segments:8 keep:4 когда изменить превышать:2 общий запускаться сбрасывать дата-файл пересоздаваться заново:2 текущий:2 стабильный учитывать:2 если:2 слишком отстать пересоздаться тот:4 как:3 попробовать смоделировать этот ситуация временно запретить подключаться порт 5432:3 iptables:3 output tcp:3 —dport drop сбросить:2 правило:2 такой неприятный картина started:2 78000000 timeline:2 fatal could not receive stream error requested segment 000000010000000000000078 has already been removed удалить прийтись делать проблема:2 есть сеть или:3 просто медленный канал между интенсивный загрузка изменение возникать риск поломка частичный решение являться увеличение значение включение работать репликационный:3 слот:3 physical:3 slot:8 'standby:2 plugin type datoid database active catalog restart lsn существующий строка slot' перезапуск снова отключить он объесть 1,10000000 потом реальный журнальный каталог show:2 расчёт максимальный wal-файл использовать формула completion target однако значительно выше сохранять информация скатить каждый копиться пора пока:2 последний удалённый мера скачивание уменьшаться видеть возобновиться tail postgresql-2014-11-27 191036 the server running and accepting connections a0000000 отличный инструмент повышать надёжность удобство описание официальный сайт www docs static warm-standby html streaming-replication-slots