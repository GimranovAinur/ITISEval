'237575 |@words техника перехват:12 функция:42 linux хорошо известный описать интернет наиболее простой:3 метод:10 заключаться написание:2 динамический:2 библиотека:4 функция-клон использование:3 механизм preload:2 для:15 переопределение таблица:3 импорт:3 этап:2 загрузка:3 процесс:15 недостаток тот:2 что:9 необходимый:4 контролировать запуск:3 уже:4 работать:4 или:4 отсутствовать можно:8 использовать:6 сплайсинг:3 запись команда:12 переход:14 перехватчик:9 начать:8 перехватывать:5 также:3 известно python:18 иметься модуль:9 ctypes:4 позволять:2 взаимодействовать дать:2 язык:3 больший:2 число:2 иметь:2 интерфейс:2 такой:2 образ:2 ничто:3 мешать:3 перехватить:2 направить:2 обернуть с-callback помощь:2 управление код:7 целевой:8 удобно:4 отладчик:2 gdb:66 который:5 поддерживать расширение:3 https sourceware org current onlinedocs python-api html нюансыкод пример:6 привести полностью конец статья:4 состоять:2 два:7 файл:7 pyinject:11 hook:68 сторона:4 оформить вид:3 пользовательский:2 новый:3 создать наследовать:2 класс:7 command:5 при:3 быть:10 вызываться invoke:2 argument from:8 tty:3 создавать:3 параметр:2 parameter:2 использоваться:4 задание имя:2 подключение pid:3 делать:2 сразу gdbgdb -ex:6 'attach:2 'source:2 'set:2 hookfile:9 py'пол это:13 отлаживать остановить:4 запустить интерактивный командный строка:3 доступный:4 условно разделить три инжектирование:2 интерпретатор:3 адресный:4 пространство:4 сбор информация:4 собственно:2 пункт:2 внутри большой:2 часть предназначить отладочный:2 возможность:2 всего:2 остальной есть execute:13 string:5 выполнить произвольный получить вывод:3 например:2 out info registers false:7 true:7 полезный parse:17 end eval:17 expression вычислять выражение возвращать:3 результат:3 value:4 один:4 дело загрузить:4 вызвать:4 dlopen:2 контекст:2 call либо and:17 'call:5 libpython2:2 rtld:4 lazy:4 assert:4 long:12 history handle:4 'dlopen:2 после:4 инициализировать pyeval:2 initthreads:2 initialize:4 вызов:9 gil global interpreter lock подготавливать c-api:2 'fopen:2 pyret:9 'pyrun:6 anyfileex:3 pyrun:2 выполнять:2 main:2 нюансывышеописать только если:4 как:3 основной скриптовый так весь:5 серьёзно усложняться основный:2 проблема:2 отладка случайный место:4 нельзя:2 никакой кроме мочь addpendingcall содержимый обозначаться декоратор:4 open:19 стандартный:2 напечатать аргумент:2 вернуть оригинальный:11 храниться пол orig:5 symbol='open:2 ctype=cfunctype:2 int:9 char:4 def:33 fname:6 oflag:7 print:5 return:24 принимать symbol:28 символ:3 предполагаться адрес:17 вместо ctype:11 задавать тип:2 регистрировать изменять deco:4 func:6 register:5 экземпляр сохранять он:4 словарь all:10 hooks:9 выполнение благодаря class:6 object:4 staticmethod:8 args:15 чтобы:2 осуществить определить:2 статический ответственный active:7 install:6 здесь:2 передаваться дополнительный:2 какой именно зависеть глобально делиться подвид способ:2 simple:3 несколько шаг восстанавливаться сохранить:3 копия производиться снова затираться инструкция:3 нюансынедостаток очевидный многопоточный:2 программа:2 гарантировать другой:4 поток:2 время:2 перезапись:2 начало:4 частично лечиться остановка во-первых нет достигнуть во-вторых словить deadlock неудачно malloc trampoline:5 копироваться новое:2 записываться тело вариант:2 всегда гораздо сложный установка перезаписывать:2 целое обычно дизассемблер приход архитектура x86 добавить ещё из-за повсеместный распространение адресация память:9 относительно:3 регистр rip:9 текущий нюансыпосмотреть gdb_0x7f6cc8aa83e0 open64+0:3 cmpl:4 0x0,0x2d33ed:2 0x7f6cc8aa83e7 open64+7 jne 0x7f6cc8aa83f9 open64+25 0x7f6cc8aa83e9:2 nocancel+0 mov 0x2:3 eax 0x7f6cc8aa83ee nocancel+5 syscall переписать относительный:2 0x2d33ed:2 сейчас указывать:2 0x7f6cc8d7b7d4 привет sigsegv:2 сделать:2 этот:2 нужно размер выделить:2 далёкий:3 чем:2 2гб:3 смещение знаковый 32-битный:3 скопировать пропатчить доступ довершение картина должный:2 короче байт:4 точка вход находиться nocancel значит наш трамплин 64-битный:3 длинный:2 принцип мощь спина корректно реализовать простота единственный ограничение длина опкод:2 дополнительно оттуда полноценный 0x7f6cc8aa83e0:3 jmp:10 0x7f6cfffff000:3 0x37556c1b абсолютный:3 равно надо:3 выделять:3 0x00007f6cc8aa83e0 jmpq:2 0x37556c1a:2 сохранный get:7 indlongjmp:5 srcaddr:7 proxyaddr:22 struct:3 pack:2 '=bbl:2 0xff:2 0x25:2 map:11 ord:2 прыжок qword теперь:2 наконец написать недоставать получать address:24 вспомогательный зона переписывать:2 предварительно self:98 code:7 proxymemory:4 void:10 cast:3 cfunc:3 memory:7 ubyte:3 len:4 list:2 patchmem:10 pyfunc:6 origfunc:5 src:7 for:5 range:2 оборачивать снимать устанавливать ofunc:4 wrap:4 val:4 последний штрих остаться находить line:4 'info:3 match:2 0-9a-f:2 addr:12 group:2 нюансыть общий случай перед тем бежать убедиться посередине собираться вернуться отпарсивый thread apply backtrace поблизости addrprot prot:14 read:3 write:10 exec:3 flags:4 private:3 anonymous:3 maddr:10 mmap:5 0x7fffffff:3 4096:4 0x00000000ffffffff:2 0xffffffff00000000:2 нюансыпоследний обход баг съедать старший битый недокументированный свойство выдавать маленький занятой желаемый без:2 трюк по-правильному чуть:2 отпарсить proc mappings найти ближний дырка вывать fixed:3 естественно обязательно целый страница каждый перехваченой разрешать иначе 'mprotect:2 -0x1000:2 вызывать через simplestringpyret simplestring:4 готовый полный количество проверка учёт многий нюанс import:4 0x1 0x4 0x10 0x20 libpython:3 'libpython2 so' paramhookfile:5 instance:5 none:7 init:5 default= super:2 param filename default set:2 show svalue:2 cmdhook:4 initialized:4 complete text:2 word matching:2 dir startswith:4 'cmd subcmd:6 dont repeat cmd:4 argv:2 elif unhook:5 else 'unknown sub-command not:6 path:4 exists 'use 'error loading try:2 except:2 error continue:3 'hook 'unhook can load library 'py isinitialized name cfunctype:2 pointer:3 lambda hex:4 uninstall:2 64-bit indirect absolute jump bytes off32:2 raise const file хороший путь py'