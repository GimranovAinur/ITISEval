'249655 |@words здравствовать уважаемый:2 читатель хабра после:3 долгий перерыв вы:4 опять продолжать копаться внутренность uefi:9 этот:11 раз:3 решить показать:2 несколько:4 техника:2 который:20 позволять упростить реверс отладка:2 исполняемый компонент пример:2 устаревшего-но-все-еще-популярный pei-модуль:14 secureupdating:5 призвать защищать прошивка:5 некоторый:2 ноутбук:7 модификация:5 предыстория таков однажды вечером я:4 написать знакомый:2 ремонтник беларусь попросить посмотреть:2 почему заменить:4 videobios' хотеть:2 стартовать:3 хотя такой:9 точно:3 ряд:2 успешно:2 ответ:4 оказаться поверхность иметь более новый:2 версия:6 добрый человек:2 интегрировать защита:2 dxe-том:4 там:8 находиться:5 нужный:6 мы:10 videobios вместе код:4 чтобы:6 злобный:2 вирус менее:2 пользователь ничто:5 сломать ненароком тогда:2 проблема решиться перенос старый:3 через:6 два:5 неделя тот:8 обратиться вновь:2 похожий:2 модуль:4 работать:4 отказаться мой:2 помощь понадобиться:4 если:14 заинтересовать дальнейший:3 приключение мир дизассемблер:3 пропатченный переход:2 добро пожаловать под кат пара:3 ссылка ликбезести почти понятно страшный есть пояснять терминология стать почитать возвращаться для:15 фанат оригинальный:5 документация всегда:4 наличие спецификация:3 весь:13 расписать намного:3 дробный необходимый:2 файл:16 инструментыдлить разборка вышеупомянутый:2 собственно быть:10 выслать вот:6 любой:4 утилит работа образ:7 использовать:5 uefitool:5 право автор мочь:3 ваш:2 вкус uefi-firmware-parser или:4 phoenixtool это:19 принципиально hex-редактор:3 выбор воспользоваться hxd поддержка pe32-файл здесь идеально подойти ida:3 demo подавлять большинство случай:6 32-битный ограничение:2 демо-версия слишком:2 сильно помешать xvilka смочь как:4 radare2 подгрузить структура:5 c-файл попробовать следующий:7 мода сделать:6 именно:5 немой пока наш:3 комплект efi-utils здоровенный behemoth:2 содержимый себя:3 определение:2 практически:2 возможный дать:10 всего:3 пара-тройка отправной точкаитак слово товарищ-ремонтник известно изменение:4 приводить:2 мёртвый моргать caps-lock' другой:4 часть:4 исход значит:2 что:9 где-то храниться:3 либо:4 контрольный:2 сумма:2 эцп:4 проверяться один:8 она:2 сойтись управление передаваться:3 фаза dxe:2 нет:2 оно:2 куда-то туда где:3 рад нужно:6 выяснить кто:2 проверять:2 главный так:7 проверка:2 заканчиваться поехать делать:3 открывать:4 смотреть внимательно вид необычный кроме сообщение:2 внутри:3 свободный:2 пространство uefi-том найтись:2 должный:2 производитель очень:4 верить обычно прятать свой:2 цифровой подпись двойной:5 щелчок выбирать самый:7 доставать он:11 целиком vol анализ:2 закрывать надо ещё:4 пригодиться:2 получить:7 рассматривать начинать конец ведь:2 место:4 том:2 только:3 тут подозрительный:2 кусок размер 100h пометить красный:2 сигнатура:4 sig:2 кодовый имя:2 платформа 68cpk вопрос:2 предположительно:2 ответить поискать:2 обращаться блок:2 бывать достаточно:2 непросто часто приходиться:2 пробовать вариант простой:2 вхождение:4 сразу:2 постигать неудача строка искаться:2 смещение:3 абсолютный адрес 12fee0h:2 переключаться искать поиск без:2 учёт заголовок:2 hex-паттерн e0ff12 процессор intel littleendian поэтому:4 порядок:2 байт:3 прийтись поменять:2 ииия бинго оба pei-модула многообещающий вынимать bin три:2 остаться разобраться немного знание:2 устройство много-много терпение запускать соглашаться условие демонстрационный режим:2 ранее идти:6 options compiler выставлять затем:3 file:6 load parse header:3 загружать список:2 uefi-структура ошибка разбор обращать внимание:2 стоить они:3 навредить теперь:5 вкладка structures edit add:2 structure:2 type:2 нажимать:2 insert быстрый standard появиться:2 находить важный pei-файл efi:10 pei:6 services:4 добавлять заодно добавить guid:2 ffs:2 совсем указатель:4 экземпляр:2 создать ядро качество параметр:3 точка:2 вход:2 каждый функция:7 потому:2 вынудить исполняться:2 непосредственно flash-память момент доступный чтение глобальный:2 переменный:4 недоступный носить неприятный программист зато:2 помогать исследование разыменование:2 популярный процедура обычный большой:2 вызов:3 pei-сервис:3 можно:5 отследить глаз:2 прямо листинг:2 вернуться начало:2 вспомнить узнать выглядеть:2 спешить гуглить status:2 efiapi:2 peimentry ffsfileheader peiservices:4 typedef:2 unsigned int stdcall указывать:2 ffs-файл вызывать хранить какой-то доступ:2 уже:3 описать выше:2 таблица вооружиться сметь менять:2 тип:4 start выделить:3 нажать:2 клавиш получаться примерно видно сначала:2 черёд чаща заниматься ввод-вывод io-порт:2 прочий магия род проверить предположение перейти:2 действительно выполнять вывод:2 порт 24eh опустить писать-читать тем:2 оказываться:2 тривиальный просто сохранять:2 выполняться оперативный память зоркий специалист заметить информация pe-файл интересный:2 особенно выставить правильный возвращать:2 значение:3 фрагмент:2 пролог обнуление локальный заметный паттерн говорить понять какой вызвать танец вокруг установить курсор eax:4 28h выбрать окно getbootmode var 134 дело:3 стек записать текущий:2 загрузка сравниваться 11h:3 равно:2 вычисление далёкий:3 класть ноль уходить return boot resume:2 система:4 просыпаться:3 acpi sleep mode местный наречие success загружаться состояние:2 исполнение итог проходить старое найти copymem копироваться буфер затираться ffh пустой заполнить изначально следовать конечно начать исследовать вообще логично поскольку скорее конкретный думать вечный лето пропускать cmp ebp+bootmode xor jnz выполниться:2 никогда:2 сам nop' готовый upd внезапно выясниться новое обстоятельство иметься копия:4 pei-том:3 восстановление тоже:2 пропатченый 05b3affd-f7cc-4c0a-a19a-a9774e2675d7 raw содержимое:3 uefitool' отображаться freeform извлечь:2 extract 12h вставить вместо replace:2 сжатый секция нуждаться патч даже ранний заключение заменять body pe32-секция модифицированный вносить dxe-тот прошивать получиться программатор отправить результат проситель часы огромный спасибо:2 клиент довольный чистый совесть пойти писать статья прочитать удачный