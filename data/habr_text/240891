'240891 |@words давний:2 время:5 быть:24 больший поклонник system:4 collections concurrent:2 blockingcollection:10 особенность сколько:3 раз:2 это:18 чудо инженерный мысль:4 выручать самый:8 разнообразный ситуация:4 счесть чуть:2 менее обиход прочно войти async:2 await:2 казалось жизнь прекрасный есть:6 один:10 асинхронный:6 код:5 миксовать блокировать:2 как-то:2 очень-то хотеться:4 как:6 несложно догадаться хотя название:2 ряд случай:4 поток:15 ложный след nito:8 asyncex:8 однажды:2 наткнуться упоминание библиотека:2 авторство stephen cleary который:17 найтись класс:4 интригующий asynccollection:9 однако взглянуть что:25 он:17 находиться:2 под капот остаться:2 некоторый недоумение там:5 оказаться:2 asynclock:2 этот:10 навесить:2 весь:12 действие:2 над:2 обернуть iproducerconsumercollection:4 свой:2 очередь:25 активно юзаета обыкновенный lock-и тонкий:2 слой магия:4 распутывать я:3 внезапно расхотеться даже:3 если:18 реализация:6 делать:8 заявить она:2 выглядеть:2 несколько:3 навороченно монструозный:2 возможно:2 очень:3 оптимально неужели нельзя:2 решить задача более аккуратно знать:4 чем чреватый подобный:3 visual studio new:28 project asyncqueue:8 для:13 начало:2 определиться вообще:2 хотеть:3 наш:7 коллекция:11 качество отправной точка можно:10 взять:4 следующий:5 интерфейс:2 public:36 interface:2 iasynccollection:13 ienumerable:3 int:25 count:12 get:3 void:12 add:23 item:36 task:17 takeasync:19 кроме тот:11 простота:2 остановиться почему:3 именно примерно причина дефолт использоваться далёкий:4 следовать:2 напрячь работа:3 связать попытка определить возможный:4 состояние:8 взгляд мочь:11 штуки_1 элемент:33 нет:2 вызов:10 task-и нужно:9 завершить:3 когда:3 появиться:2 краткость далее называть awaiter-ами awaiter-ы явно:2 где-то:2 хранить:5 напрашиваться:2 конкретный concurrentqueue:14 происходить:8 мы:9 появляться:6 новый:9 awaiter:20 закидывать:2 awaiter-:5 помощь:4 мгновенно:2 полностью симметричный предыдущий где:4 ещё:6 забрать:3 верхний оба:2 пустой:2 зависимость:2 переходить либо:4 пытаться:5 пусто:2 добавить:5 момент:4 пока:3 упс сломать сидеть разный:2 ждать друг:2 развешивать лока уйти:2 напичкать они такой:2 всякий:2 понимать прямо сейчас соседний операция:2 вот-вот завершиться после смочь:3 сделать:7 что-нибудь полезный:2 создавать:2 spinwait:18 крутиться:5 ожидание:2 попробовать:3 воспроизвести идея:5 понять:3 какой или:5 одновременно отрапортовать начать добавление:3 awaiter-а покрутиться противоположный тут:3 два требование сильно напоминать interlocked:11 хранение:2 использовать:2 что-то тип баланс:5 атомарный:3 уменьшать единица увеличивать значение:8 вернуть increment:6 decrement:2 узнать:2 грясти соответствующий:3 довольно:2 болтовня закодить вышеперечисленный class:15 private:37 itemqueue:5 taskcompletionsource:10 awaiterqueue:6 queuebalance:6 means:4 there:3 are:3 free awaiters:2 and:4 not enough items:11 the:24 opposite:2 true:12 long:4 balanceaftercurrentitem:4 ref:7 dominating:2 can:2 safely:2 queue:28 enqueue:4 else:4 least:2 one:3 available:2 being:2 added:3 're:4 speaking giving titem:11 spin:17 while:10 trydequeue:2 out:3 spinonce:8 setresult balanceaftercurrentawaiter:3 var:2 tasksource:7 return:19 returning directly trytake fromresult:2 тестировать удивление обнаруживать оно вроде:3 работать:3 победа сторона:2 другой:5 разогнаться творческий порыв так:8 просто:6 остановить плюшка посмотреть внимательно получиться:2 синхронный стоп метод:9 без:5 возможность:2 отмена:2 непорядок исправлять во-первых:2 при:8 cancellationtoken-а немедленно отменить:3 таск cancellationtoken:17 register state:4 trysetcanceled usesynchronizationcontext false:3 во-вторых:2 выковырять откуда-то середина поэтому:3 научить пропускать оный волшебный образ:5 поддерживаться автоматически bool:10 tryadd:8 returns cancellation occurred earlier trysetresult в-третьих старый:2 вынести extension static:2 asynccollectionextensions this:5 collection:10 none кстати:3 про присмотреться обязать прибить гвоздь подойти любой:2 потокобезопасный например concurrentstack:2 вот:2 titemqueue:4 where asyncstack плодить type parameter-ы принимать:2 конструктор беда подсунуть уже:3 ссылаться снаружи:2 понапихать худой часть разрушить:2 синхронизация между:2 реальный:5 запомнить:2 factory method проблема:6 прийтись сам бенчмарка:2 настать померить скорость велосипед прогон:2 бенчмарков:3 пакет benchmarkdotnet реализовать:2 куча:3 мелкий деталь желательно учитывать заюзаесть общий заключаться:2 asyncqueuebenchmark const:4 consumerthreadcount:2 producerthreadcount:3 itemsaddedperthread:3 10000 itemsaddedtotal:3 currentqueue:3 cancellationtokensource cancelsource:3 itemstaken:3 выполнение:2 измеряться ddoscurrentqueue consumertasks:2 enumerable:2 range:2 select:2 run:2 runconsumerasync:2 toarray:2 producertasks:2 runproducer:2 waitall:2 try:2 canceltoken:3 token iscancellationrequested itemstakenlocal:2 cancel break catch operationcanceledexception for i++ брать фиксировать пачка:3 фигачить параллельно разгребать засекать подсовывать сравнивать забег участвуют_1 свеженавелосипеденный asyncqueue2 вид:2 nitoasynccollectionadapter:2 region:2 members:2 threading:2 endregion:2 сравнить:2 blockingcollectionadapter:2 take результат:2 hellbrick:2 asynccollections:3 1ms stats:3 medianticks=:2 3368 medianms=:2 error=06 12ms medianticks=40503 medianms=12 error=31 2ms 7222 error=38 интуитивный оценка подвести действительно тормознуть хрень интересный:2 удаться обогнать производительность:2 обойтись:3 блокирование win открывать тортик бонусный вкусняшка ехать asyncbatchqueue:10 периодически приходиться небольшой:2 враппереть вход одиночный отдавать:2 определённый:2 размер:2 нужный:2 количество:2 набраться срабатывать таймер:5 принудительный flush:9 успеть:2 набрать кто:4 версия штука ручной flush-а:2 собранный логично средство batchsize:15 batch:27 currentbatch:9 ireadonlylist:9 batchqueue:5 здесь:2 попытаться додбавитя текущий:2 заполнить:6 за-flush-ить:2 вполне опередить данный заниматься flush-есть записать ссылка:2 отсюда добрый основный nested наглый позаимствовать читать:2 исходник рекомендовать ознакомиться много обычный массив:8 благо заранее concurrency решаться:4 поль:2 храниться индекс последнеий вставить захватить:2 последний:6 слот:7 возлагаться ответственность batch-а выходить граница повезти новое:2 осторожно нежизнеспособный поздний рассказать lastreservationindex:9 index:24 following:3 someone:3 has:4 beaten last:2 slot:2 have:3 wait until next comes along 've taken which obligated current:2 create flushinternal:7 неплохо:2 всплывать нюанс:2 никто гарантировать дать схватить:4 быстрый решение каждый флаг:2 определять finalizationflags:10 throw indexoutofrangeexception getitemwithoutvalidation:6 остальной реализоваться через теперь:2 начинаться настоящий место:3 компилятор процессор испортить переставлять инструкция:2 местами:2 кэшировать:2 категорически asyncbatchcollection прочитать закэшировать:3 заполниться вечно:2 volatile:7 спешить добавиться выходной пол:2 втыкать:3 full:6 fence:6 ensures that will:2 never before:3 set:2 thread:7 memorybarrier:4 запись:2 переставить опять prevents:3 setting finalization:2 flag:2 actual value:7 written обратный чтение:3 перед произойти сами-знаете-что reading из-за обычно навешивание модификатор представляться caching any:2 part expression стоить отступлений аналогичный весьма:2 необычный internal volatilebool:5 struct вместо структура:2 предельно экземпляр где-нибудь гарантированно возвращать финт положить скопировать опасный кончиться базовый функционал должный крайний мера искренне верить вкорячивать здорово связанный:2 многопоточность кратное остаток никогда увидеть вручную хороший простой способ чтобы сразу пометить обязательный порядок иначе реально занятый спойлер приходить compareexchange:2 всего вариант:2 развитие событие flush-ить нечего выполнить ничто:2 надо годный установить кол-в прошлое туда пролезть суть повторять пробовать tryflush:2 expectedpreviousreservation:5 read n't:3 does another about however report success avoid unnecessary spinning previousreservation:4 reservation succeeded completed time tried therefore flushed anyway even anything slipped update готовый сверху настолько лишить процесс копипейст тоже рассмотреть страдать недостаток кто-нибудь abort:2 неожиданный вылететь threadabortexception столь тщательно поддерживать консистентность вышеупомянутый экстравагантный finally insert -safe code:2 here кейс редкий защититься когда-нибудь счастие хватать минимум приоритезировать отличие тривиальный использование takefromany горизонт видно продолжение героически дочитать конец nuget:2 package www org packages source github com критика баг пожелание здравый писать рад обсудить